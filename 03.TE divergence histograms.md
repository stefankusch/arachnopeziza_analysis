#### TE divergence plots

Plot the TE divergence data.
```R
# parse data for plotting
parserm_aggregated <- as.data.frame(parserm_aggregated)
tediv <- subset(parserm_aggregated, parserm_aggregated$type == "EDTA2+TEtrimmer")
head(tediv)

# plot data
plot.te.aurata <- ggplot(subset(tediv, tediv$species == "A. aurata"), 
                         aes(x = Divergence, y = Length, fill = Rclass)) + 
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  scale_fill_manual(values = categories_color) + # Use your predefined color palette
  labs(y = "Sequence length [Mbp]", 
       x = "Sequence divergence [%]") +
  scale_x_continuous(limits = c(-1, 50), expand = c(0, 0.25)) +
  scale_y_continuous(limits = c(-1, 120000), expand = c(0, 0.25),
                     labels = c("0", "25", "50", "75", "100"), 
                     breaks = c(0, 25000, 50000, 75000, 100000)) +
  theme_classic() +
  newtheme +
  theme(legend.position = "none",
        legend.title = element_blank())
#
plot.te.aurelia <- ggplot(subset(tediv, tediv$species == "A. aurelia"), 
                         aes(x = Divergence, y = Length, fill = Rclass)) + 
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  scale_fill_manual(values = categories_color) + # Use your predefined color palette
  labs(y = "Sequence length [Mbp]", 
       x = "Sequence divergence [%]") +
  scale_x_continuous(limits = c(-1, 50), expand = c(0, 0.25)) +
  scale_y_continuous(limits = c(-1, 450000), expand = c(0, 0.25),
                     labels = c("0", "100", "200", "300", "400"), 
                     breaks = c(0, 100000, 200000, 300000, 400000)) +
  theme_classic() +
  newtheme +
  theme(legend.position = "none",
        legend.title = element_blank())
#
plot.te.Bcinerea <- ggplot(subset(tediv, tediv$species == "B. cinerea"), 
                          aes(x = Divergence, y = Length, fill = Rclass)) + 
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  scale_fill_manual(values = categories_color) + # Use your predefined color palette
  labs(y = "Sequence length [Mbp]", 
       x = "Sequence divergence [%]") +
  scale_x_continuous(limits = c(-1, 50), expand = c(0, 0.25)) +
  scale_y_continuous(limits = c(-1, 275000), expand = c(0, 0.25),
                     labels = c("0", "50", "100", "150", "200", "250"), 
                     breaks = c(0, 50000, 100000, 150000, 200000, 250000)) +
  theme_classic() +
  newtheme +
  theme(legend.position = "none",
        legend.title = element_blank())
#
plot.te.Rcommune <- ggplot(subset(tediv, tediv$species == "R. commune"), 
                           aes(x = Divergence, y = Length, fill = Rclass)) + 
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  scale_fill_manual(values = categories_color) + # Use your predefined color palette
  labs(y = "Sequence length [Mbp]", 
       x = "Sequence divergence [%]") +
  scale_x_continuous(limits = c(-1, 50), expand = c(0, 0.25)) +
  scale_y_continuous(limits = c(-1, 4200000), expand = c(0, 0.25),
                     labels = c("0", "1", "2", "3", "4"), 
                     breaks = c(0, 1000000, 2000000, 3000000, 4000000)) +
  theme_classic() +
  newtheme +
  theme(legend.position = "none",
        legend.title = element_blank())
#
plot.te.Bhordei <- ggplot(subset(tediv, tediv$species == "B. hordei"), 
                           aes(x = Divergence, y = Length, fill = Rclass)) + 
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  scale_fill_manual(values = categories_color) + # Use your predefined color palette
  labs(y = "Sequence length [Mbp]", 
       x = "Sequence divergence [%]") +
  scale_x_continuous(limits = c(-1, 50), expand = c(0, 0.25)) +
  scale_y_continuous(limits = c(-1, 35000000), expand = c(0, 0.25),
                     labels = c("0", "10", "20", "30"), 
                     breaks = c(0, 10000000, 20000000, 30000000)) +
  theme_classic() +
  newtheme +
  theme(legend.position = "none",
        legend.title = element_blank())

# save plot
plot <- plot_grid(plot.te.aurata, plot.te.aurelia, plot.ter.Bhordei, plot.te.Bcinerea, plot.te.Rcommune,
                  nrow = 1, ncol = 5, align='hv', rel_heights = c(1))
ggsave(filename="../RIP-analysis/TE_divergence.pdf", plot=plot, width = 18, height = 5)
```
